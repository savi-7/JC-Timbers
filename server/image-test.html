<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .product {
            border: 1px solid #ccc;
            margin: 10px;
            padding: 10px;
            display: inline-block;
        }
        .product img {
            width: 100px;
            height: 100px;
            object-fit: cover;
        }
    </style>
</head>
<body>
    <h1>Product Images Test</h1>
    <div id="products"></div>

    <script>
        async function loadProducts() {
            try {
                const response = await fetch('http://localhost:5001/api/products?limit=5');
                const data = await response.json();
                
                console.log('API Response:', data);
                
                const productsDiv = document.getElementById('products');
                
                if (data.products && data.products.length > 0) {
                    data.products.forEach(product => {
                        const productDiv = document.createElement('div');
                        productDiv.className = 'product';
                        
                        let imageSrc = 'https://via.placeholder.com/100x100/f3f4f6/9ca3af?text=No+Image';
                        
                        if (product.images && product.images.length > 0) {
                            const firstImage = product.images[0];
                            if (firstImage.data) {
                                if (firstImage.data.startsWith('data:')) {
                                    imageSrc = firstImage.data;
                                } else {
                                    imageSrc = `data:${firstImage.contentType || 'image/jpeg'};base64,${firstImage.data}`;
                                }
                            }
                        }
                        
                        productDiv.innerHTML = `
                            <h3>${product.name}</h3>
                            <img src="${imageSrc}" alt="${product.name}" onerror="this.src='https://via.placeholder.com/100x100/f3f4f6/9ca3af?text=Error'">
                            <p>Category: ${product.category}</p>
                            <p>Price: â‚¹${product.price}</p>
                        `;
                        
                        productsDiv.appendChild(productDiv);
                    });
                } else {
                    productsDiv.innerHTML = '<p>No products found</p>';
                }
            } catch (error) {
                console.error('Error loading products:', error);
                document.getElementById('products').innerHTML = '<p>Error loading products: ' + error.message + '</p>';
            }
        }
        
        loadProducts();
    </script>
</body>
</html>
